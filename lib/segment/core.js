/**
 * 分词器接口
 *
 * @author 老雷<leizongmin@gmail.com>
 */
'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
const POSTAG_1 = require("../POSTAG");
const index_1 = require("../mod/index");
const stringify_1 = require("./methods/stringify");
const split_1 = require("./methods/split");
const indexOf_1 = require("./methods/indexOf");
const convertSynonym_1 = require("./methods/convertSynonym");
const listModules_1 = require("./methods/listModules");
const _get_text_1 = require("./methods/_get_text");
const getOptionsDoSegment_1 = require("./methods/getOptionsDoSegment");
const useModules_1 = require("./methods/useModules");
const doSegment_1 = require("./methods/doSegment");
/**
 * 创建分词器接口
 */
class SegmentCore {
    constructor(options = {}) {
        /**
         * 分段
         *
         * 由於 segment 是利用對內容的前後文分析來進行分詞
         * 所以如何切割段落對於結果就會產生不同影響
         *
         * `RegExp` or 具有 `.[Symbol.split](input: string, limit?: number) => string[]` 的物件
         *
         * @type {Segment.ISPLIT}
         */
        this.SPLIT = /([\r\n]+|^[　\s+]+|[　\s]+$|[　\s]{2,})/gm;
        /**
         * 分段之後 如果符合以下條件 則直接忽略分析
         * `RegExp` or 具有 `.test(input: string) => boolean` 的物件
         *
         * @type {Segment.ISPLIT_FILTER}
         */
        this.SPLIT_FILTER = /^([\r\n]+)$/g;
        /**
         * 词性
         * @type {POSTAG}
         */
        this.POSTAG = POSTAG_1.default;
        /**
         * 词典表
         * @type {{}}
         */
        this.DICT = {};
        this.modules = {
            /**
             * 分词模块
             */
            tokenizer: [],
            /**
             * 优化模块
             */
            optimizer: [],
        };
        this.db = {};
        this.options = {};
        const self = this;
        this.options = Object.assign({}, this.options, options);
        this.tokenizer = new index_1.Tokenizer(this);
        this.optimizer = new index_1.Optimizer(this);
        if (this.options.db) {
            this.options.db.forEach(function (data) {
                self.db[data.type] = data;
            });
        }
        delete this.options.db;
    }
    getDictDatabase(type, autocreate, libTableDict) {
        // @ts-ignore
        return this.db[type];
    }
    use(mod, ...argv) {
        return useModules_1.useModules(this, mod, ...argv);
    }
    getDict(type) {
        return this.DICT[type];
    }
    getOptionsDoSegment(options) {
        return getOptionsDoSegment_1.getOptionsDoSegment(options, this.options.optionsDoSegment);
    }
    _get_text(text) {
        return _get_text_1._get_text(text);
    }
    addBlacklist(word, remove) {
        let me = this;
        const BLACKLIST = me.getDictDatabase("BLACKLIST" /* BLACKLIST */);
        const TABLE = me.getDictDatabase("TABLE" /* TABLE */);
        let bool = !remove;
        if (bool) {
            BLACKLIST.add(word);
            TABLE.remove(word);
        }
        else {
            BLACKLIST.remove(word);
        }
        return this;
    }
    /**
     * remove key in TABLE by BLACKLIST
     */
    doBlacklist() {
        let me = this;
        const BLACKLIST = me.getDict("BLACKLIST" /* BLACKLIST */);
        const TABLE = me.getDictDatabase("TABLE" /* TABLE */);
        Object.entries(BLACKLIST)
            .forEach(function ([key, bool]) {
            bool && TABLE.remove(key);
        });
        return this;
    }
    listModules(options = {}) {
        options = this.getOptionsDoSegment(options);
        return listModules_1.listModules(this.modules, options);
    }
    doSegment(text, options = {}) {
        const me = this;
        options = me.getOptionsDoSegment(options);
        //console.dir(options);
        let text_list = me._get_text(text)
            // @ts-ignore
            .split(this.SPLIT);
        text = undefined;
        const mods = me.listModules(options).enable;
        // 将文本按照换行符分割成多段，并逐一分词
        let ret = text_list.reduce(function (ret, section) {
            //console.dir(section);
            if (me.SPLIT_FILTER.test(section)) {
                ret = ret.concat({ w: section });
                section = [];
            }
            //section = section.trim();
            if (section.length > 0) {
                // 分词
                let sret = me.tokenizer.split(section, mods.tokenizer);
                // 优化
                sret = me.optimizer.doOptimize(sret, mods.optimizer);
                // 连接分词结果
                if (sret.length > 0) {
                    ret = ret.concat(sret);
                }
            }
            return ret;
        }, []);
        // 去除标点符号
        if (options.stripPunctuation) {
            ret = doSegment_1._doSegmentStripPOSTAG(ret, POSTAG_1.default.D_W);
        }
        if (options.convertSynonym) {
            ret = this.convertSynonym(ret);
        }
        // 去除停止符
        if (options.stripStopword) {
            ret = doSegment_1._doSegmentStripStopword(ret, me.getDict('STOPWORD'));
        }
        if (options.stripSpace) {
            ret = doSegment_1._doSegmentStripSpace(ret);
        }
        // 仅返回单词内容
        if (options.simple) {
            ret = doSegment_1._doSegmentSimple(ret);
        }
        return ret;
    }
    convertSynonym(ret, showcount) {
        return convertSynonym_1.convertSynonym(ret, {
            showcount,
            DICT_SYNONYM: this.getDict('SYNONYM'),
            DICT_TABLE: this.getDict('TABLE'),
            POSTAG: this.POSTAG,
        });
    }
    /**
     * 将单词数组连接成字符串
     *
     * @param {Array} words 单词数组
     * @return {String}
     */
    stringify(words, ...argv) {
        return stringify_1.stringify(words, ...argv);
    }
    /**
     * 将单词数组连接成字符串
     *
     * @param {Array} words 单词数组
     * @return {String}
     */
    static stringify(words, ...argv) {
        return stringify_1.stringify(words, ...argv);
    }
    /**
     * 根据某个单词或词性来分割单词数组
     *
     * @param {Array} words 单词数组
     * @param {Number|String} s 用于分割的单词或词性
     * @return {Array}
     */
    split(words, s, ...argv) {
        return split_1.split(words, s, ...argv);
    }
    /**
     * 在单词数组中查找某一个单词或词性所在的位置
     *
     * @param {Array} words 单词数组
     * @param {Number|String} s 要查找的单词或词性
     * @param {Number} cur 开始位置
     * @return {Number} 找不到，返回-1
     */
    indexOf(words, s, cur, ...argv) {
        return indexOf_1.indexOf(words, cur, ...argv);
    }
}
exports.SegmentCore = SegmentCore;
exports.default = SegmentCore;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29yZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7R0FJRztBQUVILFlBQVksQ0FBQzs7QUFLYixzQ0FBK0I7QUFVL0Isd0NBQWtGO0FBU2xGLG1EQUFnRDtBQUNoRCwyQ0FBd0M7QUFDeEMsK0NBQTRDO0FBQzVDLDZEQUF3RjtBQUN4Rix1REFBb0Q7QUFDcEQsbURBQWdEO0FBQ2hELHVFQUFvRTtBQUNwRSxxREFBa0Q7QUFDbEQsbURBSzZCO0FBSTdCOztHQUVHO0FBQ0gsTUFBYSxXQUFXO0lBK0R2QixZQUFZLFVBQTJCLEVBQUU7UUE1RHpDOzs7Ozs7Ozs7V0FTRztRQUNILFVBQUssR0FBVyx3Q0FBa0QsQ0FBQztRQUVuRTs7Ozs7V0FLRztRQUNILGlCQUFZLEdBQWtCLGNBQStCLENBQUM7UUFFOUQ7OztXQUdHO1FBQ0gsV0FBTSxHQUFHLGdCQUFNLENBQUM7UUFDaEI7OztXQUdHO1FBQ0gsU0FBSSxHQUtBLEVBQUUsQ0FBQztRQUNQLFlBQU8sR0FBRztZQUNUOztlQUVHO1lBQ0gsU0FBUyxFQUFFLEVBQUU7WUFDYjs7ZUFFRztZQUNILFNBQVMsRUFBRSxFQUFFO1NBSWIsQ0FBQztRQUtGLE9BQUUsR0FFRSxFQUFFLENBQUM7UUFFUCxZQUFPLEdBQW9CLEVBQUUsQ0FBQztRQU03QixNQUFNLElBQUksR0FBRyxJQUFJLENBQUM7UUFFbEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRXhELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxpQkFBUyxDQUFDLElBQVcsQ0FBQyxDQUFDO1FBQzVDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxpQkFBUyxDQUFDLElBQVcsQ0FBQyxDQUFDO1FBRTVDLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQ25CO1lBQ0Ms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QUFBO0lBQ2hDLENBQUM7SUFFRDs7Ozs7OztPQU9HO0lBQ0gsT0FBTyxDQUFDLEtBQWMsRUFBRSxDQUFrQixFQUFFLEdBQVksRUFBRSxHQUFHLElBQUk7UUFFaEUsT0FBTyxpQkFBTyxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQTtJQUNwQyxDQUFDO0NBRUQ7QUEzV0Qsa0NBMldDO0FBSUQsa0JBQWUsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDliIbor43lmajmjqXlj6NcbiAqXG4gKiBAYXV0aG9yIOiAgembtzxsZWl6b25nbWluQGdtYWlsLmNvbT5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbi8vIEB0cy1pZ25vcmVcbi8vIEB0cy1pZ25vcmVcbmltcG9ydCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuaW1wb3J0IFBPU1RBRyBmcm9tICcuLi9QT1NUQUcnO1xuaW1wb3J0IFRhYmxlRGljdEJsYWNrbGlzdCBmcm9tICcuLi90YWJsZS9ibGFja2xpc3QnO1xuaW1wb3J0IEFic3RyYWN0VGFibGVEaWN0Q29yZSBmcm9tICcuLi90YWJsZS9jb3JlJztcbmltcG9ydCB7IElPcHRpb25zIGFzIElPcHRpb25zVGFibGVEaWN0LCBUYWJsZURpY3QgfSBmcm9tICcuLi90YWJsZS9kaWN0JztcblxuaW1wb3J0IExvYWRlciBmcm9tICcuLi9sb2FkZXInO1xuaW1wb3J0IHsgY3JsZiB9IGZyb20gJ2NybGYtbm9ybWFsaXplJztcbmltcG9ydCB7IFRhYmxlRGljdFN0b3B3b3JkIH0gZnJvbSAnLi4vdGFibGUvc3RvcHdvcmQnO1xuaW1wb3J0IFRhYmxlRGljdFN5bm9ueW0gZnJvbSAnLi4vdGFibGUvc3lub255bSc7XG5pbXBvcnQgU2VnbWVudERpY3QgZnJvbSAnc2VnbWVudC1kaWN0JztcbmltcG9ydCB7IElTdWJPcHRpbWl6ZXIsIElTdWJUb2tlbml6ZXIsIE9wdGltaXplciwgVG9rZW5pemVyIH0gZnJvbSAnLi4vbW9kL2luZGV4JztcbmltcG9ydCB7IGRlYnVnVG9rZW4gfSBmcm9tICcuLi91dGlsL2RlYnVnJztcbmltcG9ydCB7IElXb3JkRGVidWcgfSBmcm9tICcuLi91dGlsL2luZGV4JztcblxuaW1wb3J0IGRlZXBtZXJnZSBmcm9tICdkZWVwbWVyZ2UtcGx1cy9jb3JlJztcbmltcG9ydCB7IEVudW1EaWN0RGF0YWJhc2UgfSBmcm9tICcuLi9jb25zdCc7XG5pbXBvcnQgeyBFTlVNX1NVQk1PRFMsIEVOVU1fU1VCTU9EU19OQU1FLCBFTlVNX1NVQk1PRFNfT1RIRVIgfSBmcm9tICcuLi9tb2QvaW5kZXgnO1xuaW1wb3J0IHsgZGVmYXVsdE9wdGlvbnNEb1NlZ21lbnQgfSBmcm9tICcuL2RlZmF1bHRzJztcbmltcG9ydCB7IElESUNULCBJRElDVDIsIElESUNUX0JMQUNLTElTVCwgSURJQ1RfU1RPUFdPUkQsIElESUNUX1NZTk9OWU0sIElPcHRpb25zRG9TZWdtZW50LCBJT3B0aW9uc1NlZ21lbnQsIElTUExJVCwgSVNQTElUX0ZJTFRFUiwgSVdvcmQgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IHN0cmluZ2lmeSB9IGZyb20gJy4vbWV0aG9kcy9zdHJpbmdpZnknO1xuaW1wb3J0IHsgc3BsaXQgfSBmcm9tICcuL21ldGhvZHMvc3BsaXQnO1xuaW1wb3J0IHsgaW5kZXhPZiB9IGZyb20gJy4vbWV0aG9kcy9pbmRleE9mJztcbmltcG9ydCB7IGNvbnZlcnRTeW5vbnltLCBJQ29udmVydFN5bm9ueW1XaXRoU2hvd2NvdW50IH0gZnJvbSAnLi9tZXRob2RzL2NvbnZlcnRTeW5vbnltJztcbmltcG9ydCB7IGxpc3RNb2R1bGVzIH0gZnJvbSAnLi9tZXRob2RzL2xpc3RNb2R1bGVzJztcbmltcG9ydCB7IF9nZXRfdGV4dCB9IGZyb20gJy4vbWV0aG9kcy9fZ2V0X3RleHQnO1xuaW1wb3J0IHsgZ2V0T3B0aW9uc0RvU2VnbWVudCB9IGZyb20gJy4vbWV0aG9kcy9nZXRPcHRpb25zRG9TZWdtZW50JztcbmltcG9ydCB7IHVzZU1vZHVsZXMgfSBmcm9tICcuL21ldGhvZHMvdXNlTW9kdWxlcyc7XG5pbXBvcnQge1xuXHRfZG9TZWdtZW50U2ltcGxlLFxuXHRfZG9TZWdtZW50U3RyaXBQT1NUQUcsXG5cdF9kb1NlZ21lbnRTdHJpcFNwYWNlLFxuXHRfZG9TZWdtZW50U3RyaXBTdG9wd29yZCxcbn0gZnJvbSAnLi9tZXRob2RzL2RvU2VnbWVudCc7XG5pbXBvcnQgeyBJVFNPdmVyd3JpdGUgfSBmcm9tICd0cy10eXBlJztcblxuXG4vKipcbiAqIOWIm+W7uuWIhuivjeWZqOaOpeWPo1xuICovXG5leHBvcnQgY2xhc3MgU2VnbWVudENvcmVcbntcblxuXHQvKipcblx0ICog5YiG5q61XG5cdCAqXG5cdCAqIOeUseaWvCBzZWdtZW50IOaYr+WIqeeUqOWwjeWFp+WuueeahOWJjeW+jOaWh+WIhuaekOS+humAsuihjOWIhuipnlxuXHQgKiDmiYDku6XlpoLkvZXliIflibLmrrXokL3lsI3mlrzntZDmnpzlsLHmnIPnlKLnlJ/kuI3lkIzlvbHpn79cblx0ICpcblx0ICogYFJlZ0V4cGAgb3Ig5YW35pyJIGAuW1N5bWJvbC5zcGxpdF0oaW5wdXQ6IHN0cmluZywgbGltaXQ/OiBudW1iZXIpID0+IHN0cmluZ1tdYCDnmoTnianku7Zcblx0ICpcblx0ICogQHR5cGUge1NlZ21lbnQuSVNQTElUfVxuXHQgKi9cblx0U1BMSVQ6IElTUExJVCA9IC8oW1xcclxcbl0rfF5b44CAXFxzK10rfFvjgIBcXHNdKyR8W+OAgFxcc117Mix9KS9nbSBhcyBJU1BMSVQ7XG5cblx0LyoqXG5cdCAqIOWIhuauteS5i+W+jCDlpoLmnpznrKblkIjku6XkuIvmop3ku7Yg5YmH55u05o6l5b+955Wl5YiG5p6QXG5cdCAqIGBSZWdFeHBgIG9yIOWFt+aciSBgLnRlc3QoaW5wdXQ6IHN0cmluZykgPT4gYm9vbGVhbmAg55qE54mp5Lu2XG5cdCAqXG5cdCAqIEB0eXBlIHtTZWdtZW50LklTUExJVF9GSUxURVJ9XG5cdCAqL1xuXHRTUExJVF9GSUxURVI6IElTUExJVF9GSUxURVIgPSAvXihbXFxyXFxuXSspJC9nIGFzIElTUExJVF9GSUxURVI7XG5cblx0LyoqXG5cdCAqIOivjeaAp1xuXHQgKiBAdHlwZSB7UE9TVEFHfVxuXHQgKi9cblx0UE9TVEFHID0gUE9TVEFHO1xuXHQvKipcblx0ICog6K+N5YW46KGoXG5cdCAqIEB0eXBlIHt7fX1cblx0ICovXG5cdERJQ1Q6IHtcblx0XHRTVE9QV09SRD86IElESUNUX1NUT1BXT1JELFxuXHRcdFNZTk9OWU0/OiBJRElDVF9TWU5PTllNLFxuXG5cdFx0W2tleTogc3RyaW5nXTogSURJQ1QsXG5cdH0gPSB7fTtcblx0bW9kdWxlcyA9IHtcblx0XHQvKipcblx0XHQgKiDliIbor43mqKHlnZdcblx0XHQgKi9cblx0XHR0b2tlbml6ZXI6IFtdLFxuXHRcdC8qKlxuXHRcdCAqIOS8mOWMluaooeWdl1xuXHRcdCAqL1xuXHRcdG9wdGltaXplcjogW10sXG5cdH0gYXMge1xuXHRcdHRva2VuaXplcjogSVN1YlRva2VuaXplcltdLFxuXHRcdG9wdGltaXplcjogSVN1Yk9wdGltaXplcltdLFxuXHR9O1xuXG5cdHRva2VuaXplcjogVG9rZW5pemVyO1xuXHRvcHRpbWl6ZXI6IE9wdGltaXplcjtcblxuXHRkYjoge1xuXHRcdFtrZXk6IHN0cmluZ106IFRhYmxlRGljdCxcblx0fSA9IHt9O1xuXG5cdG9wdGlvbnM6IElPcHRpb25zU2VnbWVudCA9IHt9O1xuXG5cdGluaXRlZD86IGJvb2xlYW47XG5cblx0Y29uc3RydWN0b3Iob3B0aW9uczogSU9wdGlvbnNTZWdtZW50ID0ge30pXG5cdHtcblx0XHRjb25zdCBzZWxmID0gdGhpcztcblxuXHRcdHRoaXMub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMub3B0aW9ucywgb3B0aW9ucyk7XG5cblx0XHR0aGlzLnRva2VuaXplciA9IG5ldyBUb2tlbml6ZXIodGhpcyBhcyBhbnkpO1xuXHRcdHRoaXMub3B0aW1pemVyID0gbmV3IE9wdGltaXplcih0aGlzIGFzIGFueSk7XG5cblx0XHRpZiAodGhpcy5vcHRpb25zLmRiKVxuXHRcdHtcblx0XHRcdHRoaXMub3B0aW9ucy5kYi5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhKVxuXHRcdFx0e1xuXHRcdFx0XHRzZWxmLmRiW2RhdGEudHlwZV0gPSBkYXRhO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0ZGVsZXRlIHRoaXMub3B0aW9ucy5kYjtcblx0fVxuXG5cdGdldERpY3REYXRhYmFzZTxSIGV4dGVuZHMgVGFibGVEaWN0U3lub255bT4odHlwZTogRW51bURpY3REYXRhYmFzZS5TWU5PTllNLFxuXHRcdGF1dG9jcmVhdGU/OiBib29sZWFuLFxuXHRcdGxpYlRhYmxlRGljdD86IHsgbmV3KC4uLmFyZ3YpOiBSIH0sXG5cdCk6IFJcblx0Z2V0RGljdERhdGFiYXNlPFIgZXh0ZW5kcyBUYWJsZURpY3Q+KHR5cGU6IEVudW1EaWN0RGF0YWJhc2UuVEFCTEUsIGF1dG9jcmVhdGU/OiBib29sZWFuLCBsaWJUYWJsZURpY3Q/OiB7IG5ldyguLi5hcmd2KTogUiB9KTogUlxuXHRnZXREaWN0RGF0YWJhc2U8UiBleHRlbmRzIFRhYmxlRGljdFN0b3B3b3JkPih0eXBlOiBFbnVtRGljdERhdGFiYXNlLlNUT1BXT1JELFxuXHRcdGF1dG9jcmVhdGU/OiBib29sZWFuLFxuXHRcdGxpYlRhYmxlRGljdD86IHsgbmV3KC4uLmFyZ3YpOiBSIH0sXG5cdCk6IFJcblx0Z2V0RGljdERhdGFiYXNlPFIgZXh0ZW5kcyBUYWJsZURpY3RCbGFja2xpc3Q+KHR5cGU6IEVudW1EaWN0RGF0YWJhc2UuQkxBQ0tMSVNULFxuXHRcdGF1dG9jcmVhdGU/OiBib29sZWFuLFxuXHRcdGxpYlRhYmxlRGljdD86IHsgbmV3KC4uLmFyZ3YpOiBSIH0sXG5cdCk6IFJcblx0Z2V0RGljdERhdGFiYXNlPFIgZXh0ZW5kcyBUYWJsZURpY3RCbGFja2xpc3Q+KHR5cGU6IEVudW1EaWN0RGF0YWJhc2UuQkxBQ0tMSVNUX0ZPUl9PUFRJTUlaRVIsXG5cdFx0YXV0b2NyZWF0ZT86IGJvb2xlYW4sXG5cdFx0bGliVGFibGVEaWN0PzogeyBuZXcoLi4uYXJndik6IFIgfSxcblx0KTogUlxuXHRnZXREaWN0RGF0YWJhc2U8UiBleHRlbmRzIEFic3RyYWN0VGFibGVEaWN0Q29yZTxhbnk+Pih0eXBlOiBzdHJpbmcgfCBFbnVtRGljdERhdGFiYXNlLFxuXHRcdGF1dG9jcmVhdGU/OiBib29sZWFuLFxuXHRcdGxpYlRhYmxlRGljdD86IHsgbmV3KC4uLmFyZ3YpOiBSIH0sXG5cdCk6IFJcblx0Z2V0RGljdERhdGFiYXNlKHR5cGU6IHN0cmluZywgYXV0b2NyZWF0ZT86IGJvb2xlYW4sIGxpYlRhYmxlRGljdD8pXG5cdHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0cmV0dXJuIHRoaXMuZGJbdHlwZV07XG5cdH1cblxuXHQvKipcblx0ICog6L295YWl5YiG6K+N5qih5Z2XXG5cdCAqXG5cdCAqIEBwYXJhbSB7U3RyaW5nfEFycmF5fE9iamVjdH0gbW9kdWxlIOaooeWdl+WQjeensCjmlbDnu4Qp5oiW5qih5Z2X5a+56LGhXG5cdCAqIEByZXR1cm4ge1NlZ21lbnR9XG5cdCAqL1xuXHR1c2UobW9kOiBJU3ViT3B0aW1pemVyLCAuLi5hcmd2KTogdGhpc1xuXHR1c2UobW9kOiBJU3ViVG9rZW5pemVyLCAuLi5hcmd2KTogdGhpc1xuXHR1c2UobW9kLCAuLi5hcmd2KTogdGhpc1xuXHR1c2UobW9kLCAuLi5hcmd2KVxuXHR7XG5cdFx0cmV0dXJuIHVzZU1vZHVsZXModGhpcywgbW9kLCAuLi5hcmd2KTtcblx0fVxuXG5cdC8qKlxuXHQgKiDlj5bor43lhbjooahcblx0ICpcblx0ICogQHBhcmFtIHtTdHJpbmd9IHR5cGUg57G75Z6LXG5cdCAqIEByZXR1cm4ge29iamVjdH1cblx0ICovXG5cdGdldERpY3QodHlwZTogRW51bURpY3REYXRhYmFzZS5TVE9QV09SRCk6IElESUNUX1NUT1BXT1JEXG5cdGdldERpY3QodHlwZTogRW51bURpY3REYXRhYmFzZS5TWU5PTllNKTogSURJQ1RfU1lOT05ZTVxuXHRnZXREaWN0KHR5cGU6IEVudW1EaWN0RGF0YWJhc2UuVEFCTEUpOiBJRElDVDxJV29yZD5cblx0Z2V0RGljdCh0eXBlOiBFbnVtRGljdERhdGFiYXNlLkJMQUNLTElTVCk6IElESUNUX0JMQUNLTElTVFxuXHRnZXREaWN0KHR5cGU6IEVudW1EaWN0RGF0YWJhc2UuQkxBQ0tMSVNUX0ZPUl9PUFRJTUlaRVIpOiBJRElDVF9CTEFDS0xJU1Rcblx0Z2V0RGljdCh0eXBlOiAnVEFCTEUyJyk6IElESUNUMjxJV29yZD5cblx0Z2V0RGljdCh0eXBlOiBFbnVtRGljdERhdGFiYXNlKTogSURJQ1Rcblx0Z2V0RGljdCh0eXBlKTogSURJQ1Rcblx0Z2V0RGljdCh0eXBlKVxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuRElDVFt0eXBlXTtcblx0fVxuXG5cdGdldE9wdGlvbnNEb1NlZ21lbnQ8VCBleHRlbmRzIElPcHRpb25zRG9TZWdtZW50PihvcHRpb25zPzogVCk6IFRcblx0e1xuXHRcdHJldHVybiBnZXRPcHRpb25zRG9TZWdtZW50PFQ+KG9wdGlvbnMsIHRoaXMub3B0aW9ucy5vcHRpb25zRG9TZWdtZW50KVxuXHR9XG5cblx0cHJvdGVjdGVkIF9nZXRfdGV4dCh0ZXh0OiBzdHJpbmcgfCBCdWZmZXIpOiBzdHJpbmdcblx0e1xuXHRcdHJldHVybiBfZ2V0X3RleHQodGV4dClcblx0fVxuXG5cdGFkZEJsYWNrbGlzdCh3b3JkOiBzdHJpbmcsIHJlbW92ZT86IGJvb2xlYW4pXG5cdHtcblx0XHRsZXQgbWUgPSB0aGlzO1xuXG5cdFx0Y29uc3QgQkxBQ0tMSVNUID0gbWUuZ2V0RGljdERhdGFiYXNlKEVudW1EaWN0RGF0YWJhc2UuQkxBQ0tMSVNUKTtcblx0XHRjb25zdCBUQUJMRSA9IG1lLmdldERpY3REYXRhYmFzZShFbnVtRGljdERhdGFiYXNlLlRBQkxFKTtcblxuXHRcdGxldCBib29sID0gIXJlbW92ZTtcblxuXHRcdGlmIChib29sKVxuXHRcdHtcblx0XHRcdEJMQUNLTElTVC5hZGQod29yZCk7XG5cdFx0XHRUQUJMRS5yZW1vdmUod29yZCk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHRCTEFDS0xJU1QucmVtb3ZlKHdvcmQpXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXNcblx0fVxuXG5cdC8qKlxuXHQgKiByZW1vdmUga2V5IGluIFRBQkxFIGJ5IEJMQUNLTElTVFxuXHQgKi9cblx0ZG9CbGFja2xpc3QoKVxuXHR7XG5cdFx0bGV0IG1lID0gdGhpcztcblxuXHRcdGNvbnN0IEJMQUNLTElTVCA9IG1lLmdldERpY3QoRW51bURpY3REYXRhYmFzZS5CTEFDS0xJU1QpO1xuXHRcdGNvbnN0IFRBQkxFID0gbWUuZ2V0RGljdERhdGFiYXNlKEVudW1EaWN0RGF0YWJhc2UuVEFCTEUpO1xuXG5cdFx0T2JqZWN0LmVudHJpZXMoQkxBQ0tMSVNUKVxuXHRcdFx0LmZvckVhY2goZnVuY3Rpb24gKFtrZXksIGJvb2xdKVxuXHRcdFx0e1xuXHRcdFx0XHRib29sICYmIFRBQkxFLnJlbW92ZShrZXkpXG5cdFx0XHR9KVxuXHRcdDtcblxuXHRcdHJldHVybiB0aGlzXG5cdH1cblxuXHRsaXN0TW9kdWxlcyhvcHRpb25zOiBJT3B0aW9uc0RvU2VnbWVudCA9IHt9KVxuXHR7XG5cdFx0b3B0aW9ucyA9IHRoaXMuZ2V0T3B0aW9uc0RvU2VnbWVudChvcHRpb25zKTtcblxuXHRcdHJldHVybiBsaXN0TW9kdWxlcyh0aGlzLm1vZHVsZXMsIG9wdGlvbnMpO1xuXHR9XG5cblx0LyoqXG5cdCAqIOW8gOWni+WIhuivjVxuXHQgKlxuXHQgKiBAcGFyYW0ge1N0cmluZ30gdGV4dCDmlofmnKxcblx0ICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg6YCJ6aG5XG5cdCAqICAgLSB7Qm9vbGVhbn0gc2ltcGxlIOaYr+WQpuS7hei/lOWbnuWNleivjeWGheWuuVxuXHQgKiAgIC0ge0Jvb2xlYW59IHN0cmlwUHVuY3R1YXRpb24g5Y676Zmk5qCH54K556ym5Y+3XG5cdCAqICAgLSB7Qm9vbGVhbn0gY29udmVydFN5bm9ueW0g6L2s5o2i5ZCM5LmJ6K+NXG5cdCAqICAgLSB7Qm9vbGVhbn0gc3RyaXBTdG9wd29yZCDljrvpmaTlgZzmraLnrKZcblx0ICogQHJldHVybiB7QXJyYXl9XG5cdCAqL1xuXHRkb1NlZ21lbnQodGV4dDogc3RyaW5nIHwgQnVmZmVyLCBvcHRpb25zOiBJVFNPdmVyd3JpdGU8SU9wdGlvbnNEb1NlZ21lbnQsIHtcblx0XHRzaW1wbGU6IHRydWUsXG5cdH0+KTogc3RyaW5nW11cblx0ZG9TZWdtZW50KHRleHQ6IHN0cmluZyB8IEJ1ZmZlciwgb3B0aW9ucz86IElPcHRpb25zRG9TZWdtZW50KTogSVdvcmRbXVxuXHRkb1NlZ21lbnQodGV4dCwgb3B0aW9uczogSU9wdGlvbnNEb1NlZ21lbnQgPSB7fSlcblx0e1xuXHRcdGNvbnN0IG1lID0gdGhpcztcblxuXHRcdG9wdGlvbnMgPSBtZS5nZXRPcHRpb25zRG9TZWdtZW50KG9wdGlvbnMpO1xuXG5cdFx0Ly9jb25zb2xlLmRpcihvcHRpb25zKTtcblxuXHRcdGxldCB0ZXh0X2xpc3QgPSBtZS5fZ2V0X3RleHQodGV4dClcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdC5zcGxpdCh0aGlzLlNQTElUKVxuXHRcdDtcblx0XHR0ZXh0ID0gdW5kZWZpbmVkO1xuXG5cdFx0Y29uc3QgbW9kcyA9IG1lLmxpc3RNb2R1bGVzKG9wdGlvbnMpLmVuYWJsZTtcblxuXHRcdC8vIOWwhuaWh+acrOaMieeFp+aNouihjOespuWIhuWJsuaIkOWkmuaute+8jOW5tumAkOS4gOWIhuivjVxuXHRcdGxldCByZXQgPSB0ZXh0X2xpc3QucmVkdWNlKGZ1bmN0aW9uIChyZXQsIHNlY3Rpb24pXG5cdFx0e1xuXHRcdFx0Ly9jb25zb2xlLmRpcihzZWN0aW9uKTtcblxuXHRcdFx0aWYgKG1lLlNQTElUX0ZJTFRFUi50ZXN0KHNlY3Rpb24pKVxuXHRcdFx0e1xuXHRcdFx0XHRyZXQgPSByZXQuY29uY2F0KHsgdzogc2VjdGlvbiB9KTtcblxuXHRcdFx0XHRzZWN0aW9uID0gW107XG5cdFx0XHR9XG5cblx0XHRcdC8vc2VjdGlvbiA9IHNlY3Rpb24udHJpbSgpO1xuXHRcdFx0aWYgKHNlY3Rpb24ubGVuZ3RoID4gMClcblx0XHRcdHtcblx0XHRcdFx0Ly8g5YiG6K+NXG5cdFx0XHRcdGxldCBzcmV0ID0gbWUudG9rZW5pemVyLnNwbGl0KHNlY3Rpb24sIG1vZHMudG9rZW5pemVyKTtcblxuXHRcdFx0XHQvLyDkvJjljJZcblx0XHRcdFx0c3JldCA9IG1lLm9wdGltaXplci5kb09wdGltaXplKHNyZXQsIG1vZHMub3B0aW1pemVyKTtcblxuXHRcdFx0XHQvLyDov57mjqXliIbor43nu5Pmnpxcblx0XHRcdFx0aWYgKHNyZXQubGVuZ3RoID4gMClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHJldCA9IHJldC5jb25jYXQoc3JldCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHJldDtcblx0XHR9LCBbXSk7XG5cblx0XHQvLyDljrvpmaTmoIfngrnnrKblj7dcblx0XHRpZiAob3B0aW9ucy5zdHJpcFB1bmN0dWF0aW9uKVxuXHRcdHtcblx0XHRcdHJldCA9IF9kb1NlZ21lbnRTdHJpcFBPU1RBRyhyZXQsIFBPU1RBRy5EX1cpXG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbnMuY29udmVydFN5bm9ueW0pXG5cdFx0e1xuXHRcdFx0cmV0ID0gdGhpcy5jb252ZXJ0U3lub255bShyZXQpO1xuXHRcdH1cblxuXHRcdC8vIOWOu+mZpOWBnOatouesplxuXHRcdGlmIChvcHRpb25zLnN0cmlwU3RvcHdvcmQpXG5cdFx0e1xuXHRcdFx0cmV0ID0gX2RvU2VnbWVudFN0cmlwU3RvcHdvcmQocmV0LCBtZS5nZXREaWN0KCdTVE9QV09SRCcpKVxuXHRcdH1cblxuXHRcdGlmIChvcHRpb25zLnN0cmlwU3BhY2UpXG5cdFx0e1xuXHRcdFx0cmV0ID0gX2RvU2VnbWVudFN0cmlwU3BhY2UocmV0KVxuXHRcdH1cblxuXHRcdC8vIOS7hei/lOWbnuWNleivjeWGheWuuVxuXHRcdGlmIChvcHRpb25zLnNpbXBsZSlcblx0XHR7XG5cdFx0XHRyZXQgPSBfZG9TZWdtZW50U2ltcGxlKHJldClcblx0XHR9XG5cblx0XHRyZXR1cm4gcmV0O1xuXHR9XG5cblx0LyoqXG5cdCAqIOi9rOaNouWQjOS5ieivjVxuXHQgKi9cblx0Y29udmVydFN5bm9ueW0ocmV0OiBJV29yZERlYnVnW10sIHNob3djb3VudDogdHJ1ZSk6IHtcblx0XHRjb3VudDogbnVtYmVyLFxuXHRcdGxpc3Q6IElXb3JkRGVidWdbXSxcblx0fVxuXHQvKipcblx0ICog6L2s5o2i5ZCM5LmJ6K+NXG5cdCAqL1xuXHRjb252ZXJ0U3lub255bShyZXQ6IElXb3JkRGVidWdbXSwgc2hvd2NvdW50PzogYm9vbGVhbik6IElXb3JkRGVidWdbXVxuXHRjb252ZXJ0U3lub255bShyZXQ6IElXb3JkRGVidWdbXSwgc2hvd2NvdW50PzogYm9vbGVhbilcblx0e1xuXHRcdHJldHVybiBjb252ZXJ0U3lub255bShyZXQsIHtcblx0XHRcdHNob3djb3VudCxcblx0XHRcdERJQ1RfU1lOT05ZTTogdGhpcy5nZXREaWN0KCdTWU5PTllNJyksXG5cdFx0XHRESUNUX1RBQkxFOiB0aGlzLmdldERpY3QoJ1RBQkxFJyksXG5cdFx0XHRQT1NUQUc6IHRoaXMuUE9TVEFHLFxuXHRcdH0pIGFzIElXb3JkRGVidWdbXSB8IElDb252ZXJ0U3lub255bVdpdGhTaG93Y291bnQ7XG5cdH1cblxuXHQvKipcblx0ICog5bCG5Y2V6K+N5pWw57uE6L+e5o6l5oiQ5a2X56ym5LiyXG5cdCAqXG5cdCAqIEBwYXJhbSB7QXJyYXl9IHdvcmRzIOWNleivjeaVsOe7hFxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9XG5cdCAqL1xuXHRzdHJpbmdpZnkod29yZHM6IEFycmF5PElXb3JkIHwgc3RyaW5nPiwgLi4uYXJndik6IHN0cmluZ1xuXHR7XG5cdFx0cmV0dXJuIHN0cmluZ2lmeSh3b3JkcywgLi4uYXJndik7XG5cdH1cblxuXHQvKipcblx0ICog5bCG5Y2V6K+N5pWw57uE6L+e5o6l5oiQ5a2X56ym5LiyXG5cdCAqXG5cdCAqIEBwYXJhbSB7QXJyYXl9IHdvcmRzIOWNleivjeaVsOe7hFxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9XG5cdCAqL1xuXHRzdGF0aWMgc3RyaW5naWZ5KHdvcmRzOiBBcnJheTxJV29yZCB8IHN0cmluZz4sIC4uLmFyZ3YpOiBzdHJpbmdcblx0e1xuXHRcdHJldHVybiBzdHJpbmdpZnkod29yZHMsIC4uLmFyZ3YpXG5cdH1cblxuXHQvKipcblx0ICog5qC55o2u5p+Q5Liq5Y2V6K+N5oiW6K+N5oCn5p2l5YiG5Ymy5Y2V6K+N5pWw57uEXG5cdCAqXG5cdCAqIEBwYXJhbSB7QXJyYXl9IHdvcmRzIOWNleivjeaVsOe7hFxuXHQgKiBAcGFyYW0ge051bWJlcnxTdHJpbmd9IHMg55So5LqO5YiG5Ymy55qE5Y2V6K+N5oiW6K+N5oCnXG5cdCAqIEByZXR1cm4ge0FycmF5fVxuXHQgKi9cblx0c3BsaXQod29yZHM6IElXb3JkW10sIHM6IHN0cmluZyB8IG51bWJlciwgLi4uYXJndik6IElXb3JkW11cblx0e1xuXHRcdHJldHVybiBzcGxpdCh3b3JkcywgcywgLi4uYXJndilcblx0fVxuXG5cdC8qKlxuXHQgKiDlnKjljZXor43mlbDnu4TkuK3mn6Xmib7mn5DkuIDkuKrljZXor43miJbor43mgKfmiYDlnKjnmoTkvY3nva5cblx0ICpcblx0ICogQHBhcmFtIHtBcnJheX0gd29yZHMg5Y2V6K+N5pWw57uEXG5cdCAqIEBwYXJhbSB7TnVtYmVyfFN0cmluZ30gcyDopoHmn6Xmib7nmoTljZXor43miJbor43mgKdcblx0ICogQHBhcmFtIHtOdW1iZXJ9IGN1ciDlvIDlp4vkvY3nva5cblx0ICogQHJldHVybiB7TnVtYmVyfSDmib7kuI3liLDvvIzov5Tlm54tMVxuXHQgKi9cblx0aW5kZXhPZih3b3JkczogSVdvcmRbXSwgczogc3RyaW5nIHwgbnVtYmVyLCBjdXI/OiBudW1iZXIsIC4uLmFyZ3YpXG5cdHtcblx0XHRyZXR1cm4gaW5kZXhPZih3b3JkcywgY3VyLCAuLi5hcmd2KVxuXHR9XG5cbn1cblxuZXhwb3J0IHsgSURJQ1QsIElESUNUMiwgSURJQ1RfQkxBQ0tMSVNULCBJRElDVF9TVE9QV09SRCwgSURJQ1RfU1lOT05ZTSwgSU9wdGlvbnNEb1NlZ21lbnQsIElPcHRpb25zU2VnbWVudCwgSVNQTElULCBJU1BMSVRfRklMVEVSLCBJV29yZCB9XG5cbmV4cG9ydCBkZWZhdWx0IFNlZ21lbnRDb3JlO1xuIl19